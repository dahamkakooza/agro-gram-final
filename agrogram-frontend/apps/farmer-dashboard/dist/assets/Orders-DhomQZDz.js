import{j as e,C as E,B as h,r as t,A as P,a as W,u as X,m as $,b as Z,l as ee}from"./index-C07V4r8E.js";import{S as C}from"./Select-CJWIEbcx.js";import{I as A}from"./input-kLXWFfVH.js";import{T as k}from"./TextArea-Dt6jrW99.js";const se=({order:a,onSubmit:R,onCancel:p})=>{var y;if(!a)return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{children:"Error"}),e.jsx("p",{children:"Order information is not available"})]}),e.jsx("div",{className:"form-actions",children:e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Close"})})]});const[r,_]=t.useState(""),[n,g]=t.useState(!1),[l,v]=t.useState(""),b=[{value:"changed_mind",label:"Changed my mind"},{value:"found_cheaper",label:"Found a better price"},{value:"ordered_by_mistake",label:"Ordered by mistake"},{value:"delivery_too_long",label:"Delivery takes too long"},{value:"product_not_needed",label:"No longer need the product"},{value:"financial_reasons",label:"Financial reasons"},{value:"other",label:"Other reason"}],c=async f=>{if(f.preventDefault(),!r.trim()){v("Please select a cancellation reason");return}g(!0),v("");try{await R({orderId:a.id,action:"CANCEL_ORDER",reason:r,additionalDetails:r==="other"?document.getElementById("otherReason").value:""})}catch{v("Failed to cancel order")}finally{g(!1)}};return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsxs("h3",{children:["Cancel Order #",a.id]}),e.jsx("p",{children:"Please tell us why you're cancelling this order"})]}),e.jsxs("form",{onSubmit:c,children:[l&&e.jsx(P,{type:"error",children:l}),e.jsx("div",{className:"form-section",children:e.jsx(C,{label:"Cancellation Reason *",options:b,value:r,onChange:f=>_(f.target.value),required:!0})}),r==="other"&&e.jsx("div",{className:"form-section",children:e.jsx(k,{label:"Please specify your reason *",id:"otherReason",rows:3,placeholder:"Please provide details about why you're cancelling this order...",required:!0})}),e.jsxs("div",{className:"order-summary",children:[e.jsx("h4",{children:"Order Summary"}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Product:"}),e.jsx("span",{children:((y=a.product_details)==null?void 0:y.title)||"Product"})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Quantity:"}),e.jsx("span",{children:a.quantity||1})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Total Amount:"}),e.jsxs("span",{children:["$",a.total_price||0]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx(h,{type:"submit",variant:"error",loading:n,disabled:!r.trim(),children:"Confirm Cancellation"}),e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Go Back"})]}),e.jsx("div",{className:"form-notice",children:e.jsxs("p",{children:["⚠️ ",e.jsx("strong",{children:"Note:"})," Once cancelled, this order cannot be restored. The seller will be notified of your cancellation."]})})]})]})},ae=({order:a,onSubmit:R,onCancel:p})=>{var D;if(!a)return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{children:"Error"}),e.jsx("p",{children:"Order information is not available"})]}),e.jsx("div",{className:"form-actions",children:e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Close"})})]});const[r,_]=t.useState(""),[n,g]=t.useState(""),[l,v]=t.useState(""),[b,c]=t.useState(!1),[y,f]=t.useState(""),o=[{value:"full_refund",label:"Full Refund"},{value:"partial_refund",label:"Partial Refund"},{value:"exchange",label:"Exchange Product"}],N=[{value:"damaged_product",label:"Product arrived damaged"},{value:"wrong_item",label:"Wrong item received"},{value:"not_as_described",label:"Product not as described"},{value:"missing_parts",label:"Missing parts/accessories"},{value:"quality_issue",label:"Poor quality"},{value:"late_delivery",label:"Extremely late delivery"},{value:"other",label:"Other reason"}],x=async m=>{if(m.preventDefault(),!r||!n){f("Please fill in all required fields");return}c(!0),f("");try{await R({orderId:a.id,action:"REQUEST_REFUND",refundType:r,reason:n,description:l,requestedAmount:r==="partial_refund"?document.getElementById("refundAmount").value:a.total_price})}catch{f("Failed to submit refund request")}finally{c(!1)}};return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsxs("h3",{children:["Request Refund - Order #",a.id]}),e.jsx("p",{children:"Submit a refund request for this order"})]}),e.jsxs("form",{onSubmit:x,children:[y&&e.jsx(P,{type:"error",children:y}),e.jsx("div",{className:"form-section",children:e.jsx(C,{label:"Refund Type *",options:o,value:r,onChange:m=>_(m.target.value),required:!0})}),r==="partial_refund"&&e.jsx("div",{className:"form-section",children:e.jsx(A,{label:"Refund Amount *",id:"refundAmount",type:"number",min:"1",max:a.total_price||0,placeholder:`Maximum: $${a.total_price||0}`,required:!0})}),e.jsx("div",{className:"form-section",children:e.jsx(C,{label:"Refund Reason *",options:N,value:n,onChange:m=>g(m.target.value),required:!0})}),e.jsx("div",{className:"form-section",children:e.jsx(k,{label:"Detailed Description *",rows:4,placeholder:"Please provide detailed information about why you're requesting a refund. Include any relevant details about the issue...",value:l,onChange:m=>v(m.target.value),required:!0})}),e.jsx("div",{className:"form-section",children:e.jsxs("label",{className:"file-upload-label",children:["Upload Evidence (Optional)",e.jsx("input",{type:"file",accept:"image/*,.pdf",multiple:!0}),e.jsx("small",{children:"Photos, videos, or documents supporting your refund request"})]})}),e.jsxs("div",{className:"order-summary",children:[e.jsx("h4",{children:"Order Details"}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Product:"}),e.jsx("span",{children:((D=a.product_details)==null?void 0:D.title)||"Product"})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Order Date:"}),e.jsx("span",{children:a.created_at?new Date(a.created_at).toLocaleDateString():"Unknown"})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Total Paid:"}),e.jsxs("span",{children:["$",a.total_price||0]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx(h,{type:"submit",variant:"primary",loading:b,disabled:!r||!n||!l.trim(),children:"Submit Refund Request"}),e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Cancel"})]}),e.jsx("div",{className:"form-notice",children:e.jsxs("p",{children:["📞 ",e.jsx("strong",{children:"Support:"})," Our team will review your request within 24-48 hours. You may be contacted for additional information."]})})]})]})},re=({order:a,onSubmit:R,onCancel:p})=>{if(!a)return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{children:"Error"}),e.jsx("p",{children:"Order information is not available"})]}),e.jsx("div",{className:"form-actions",children:e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Close"})})]});const[r,_]=t.useState(""),[n,g]=t.useState(0),[l,v]=t.useState(""),[b,c]=t.useState(!1),y=[{value:"excellent",label:"Excellent - Perfect condition"},{value:"good",label:"Good - Minor issues"},{value:"fair",label:"Fair - Noticeable issues"},{value:"poor",label:"Poor - Significant problems"}],f=async o=>{o.preventDefault(),c(!0);try{await R({orderId:a.id,action:"CONFIRM_DELIVERY",condition:r,rating:n,feedback:l,confirmedAt:new Date().toISOString()})}finally{c(!1)}};return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsxs("h3",{children:["Confirm Delivery - Order #",a.id]}),e.jsx("p",{children:"Please confirm you've received your order"})]}),e.jsxs("form",{onSubmit:f,children:[e.jsx("div",{className:"form-section",children:e.jsx(C,{label:"Product Condition *",options:y,value:r,onChange:o=>_(o.target.value),required:!0})}),e.jsx("div",{className:"form-section",children:e.jsxs("label",{className:"rating-label",children:["Delivery Experience Rating *",e.jsx("div",{className:"star-rating",children:[1,2,3,4,5].map(o=>e.jsx("button",{type:"button",className:`star ${o<=n?"active":""}`,onClick:()=>g(o),children:"⭐"},o))}),e.jsx("small",{children:"Rate your overall delivery experience"})]})}),e.jsx("div",{className:"form-section",children:e.jsx(k,{label:"Delivery Feedback (Optional)",rows:3,placeholder:"Any comments about the delivery process, packaging, or overall experience...",value:l,onChange:o=>v(o.target.value)})}),e.jsxs("div",{className:"delivery-checklist",children:[e.jsx("h4",{children:"Please verify:"}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",required:!0}),e.jsx("span",{children:"I have received the complete order"})]}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",required:!0}),e.jsx("span",{children:"The product matches the description"})]}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",required:!0}),e.jsx("span",{children:"I understand this confirms successful delivery"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx(h,{type:"submit",variant:"success",loading:b,disabled:!r||n===0,children:"Confirm Successful Delivery"}),e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Not Yet Received"})]}),e.jsx("div",{className:"form-notice",children:e.jsxs("p",{children:["✅ ",e.jsx("strong",{children:"Note:"})," Confirming delivery completes your order. You can still request a refund later if issues arise."]})})]})]})},te=({order:a,onSubmit:R,onCancel:p})=>{var N;if(!a)return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{children:"Error"}),e.jsx("p",{children:"Order information is not available"})]}),e.jsx("div",{className:"form-actions",children:e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Close"})})]});const[r,_]=t.useState(""),[n,g]=t.useState(""),[l,v]=t.useState(!1),[b,c]=t.useState(""),y=[{value:"1",label:"1 business day"},{value:"2",label:"2 business days"},{value:"3",label:"3 business days"},{value:"5",label:"5 business days"},{value:"7",label:"1 week"},{value:"custom",label:"Custom timeframe"}],f=async x=>{if(x.preventDefault(),!r){c("Please select processing time");return}v(!0),c("");try{await R({orderId:a.id,action:"CONFIRM_ORDER",processingTime:r,notes:n,estimatedShipDate:o(r),confirmedAt:new Date().toISOString()})}catch{c("Failed to confirm order")}finally{v(!1)}},o=x=>{const D=parseInt(x)||3,m=new Date;return m.setDate(m.getDate()+D),m.toISOString()};return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsxs("h3",{children:["Confirm Order #",a.id]}),e.jsx("p",{children:"Confirm you can fulfill this order"})]}),e.jsxs("form",{onSubmit:f,children:[b&&e.jsx(P,{type:"error",children:b}),e.jsxs("div",{className:"form-section",children:[e.jsx(C,{label:"Estimated Processing Time *",options:y,value:r,onChange:x=>_(x.target.value),required:!0}),r==="custom"&&e.jsx(A,{label:"Custom Processing Time",placeholder:"e.g., 10-14 business days",required:!0})]}),e.jsx("div",{className:"form-section",children:e.jsx(k,{label:"Order Notes (Optional)",rows:3,placeholder:"Any special notes for the buyer, production details, or additional information...",value:n,onChange:x=>g(x.target.value)})}),e.jsxs("div",{className:"order-summary",children:[e.jsx("h4",{children:"Order Commitment"}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Buyer:"}),e.jsx("span",{children:a.buyer_name||a.buyer_email||"Unknown"})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Product:"}),e.jsx("span",{children:((N=a.product_details)==null?void 0:N.title)||"Product"})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Quantity:"}),e.jsx("span",{children:a.quantity||1})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Total Amount:"}),e.jsxs("span",{children:["$",a.total_price||0]})]})]}),e.jsxs("div",{className:"commitment-checklist",children:[e.jsx("h4",{children:"By confirming, you agree to:"}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",required:!0}),e.jsx("span",{children:"Process and ship this order within the specified timeframe"})]}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",required:!0}),e.jsx("span",{children:"Provide quality products as described"})]}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",required:!0}),e.jsx("span",{children:"Maintain communication with the buyer"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx(h,{type:"submit",variant:"success",loading:l,disabled:!r,children:"Confirm Order"}),e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Cancel"})]})]})]})},ie=({order:a,onSubmit:R,onCancel:p})=>{var o;if(!a)return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{children:"Error"}),e.jsx("p",{children:"Order information is not available"})]}),e.jsx("div",{className:"form-actions",children:e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Close"})})]});const[r,_]=t.useState(""),[n,g]=t.useState(""),[l,v]=t.useState(!1),[b,c]=t.useState(""),y=[{value:"out_of_stock",label:"Product out of stock"},{value:"production_issue",label:"Production issues"},{value:"pricing_error",label:"Pricing error"},{value:"cannot_fulfill",label:"Cannot fulfill order requirements"},{value:"suspicious_order",label:"Suspicious order activity"},{value:"other",label:"Other reason"}],f=async N=>{if(N.preventDefault(),!r.trim()){c("Please select a rejection reason");return}v(!0),c("");try{await R({orderId:a.id,action:"REJECT_ORDER",reason:r,details:n,rejectedAt:new Date().toISOString()})}catch{c("Failed to reject order")}finally{v(!1)}};return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsxs("h3",{children:["Reject Order #",a.id]}),e.jsx("p",{children:"Please provide reason for rejecting this order"})]}),e.jsxs("form",{onSubmit:f,children:[b&&e.jsx(P,{type:"error",children:b}),e.jsx("div",{className:"form-section",children:e.jsx(C,{label:"Rejection Reason *",options:y,value:r,onChange:N=>_(N.target.value),required:!0})}),e.jsx("div",{className:"form-section",children:e.jsx(k,{label:"Detailed Explanation *",rows:4,placeholder:"Please provide a detailed explanation for rejecting this order. This will be shared with the buyer...",value:n,onChange:N=>g(N.target.value),required:!0})}),e.jsx("div",{className:"form-section",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",required:!0}),e.jsx("span",{children:"I understand this action cannot be undone and the buyer will be notified"})]})}),e.jsxs("div",{className:"order-summary",children:[e.jsx("h4",{children:"Order Being Rejected"}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Buyer:"}),e.jsx("span",{children:a.buyer_name||a.buyer_email||"Unknown"})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Product:"}),e.jsx("span",{children:((o=a.product_details)==null?void 0:o.title)||"Product"})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Order Total:"}),e.jsxs("span",{children:["$",a.total_price||0]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx(h,{type:"submit",variant:"error",loading:l,disabled:!r||!n.trim(),children:"Confirm Rejection"}),e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Go Back"})]}),e.jsx("div",{className:"form-notice",children:e.jsxs("p",{children:["⚠️ ",e.jsx("strong",{children:"Important:"})," Frequent order rejections may affect your seller rating and visibility."]})})]})]})},ne=({order:a,onSubmit:R,onCancel:p})=>{if(!a)return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{children:"Error"}),e.jsx("p",{children:"Order information is not available"})]}),e.jsx("div",{className:"form-actions",children:e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Close"})})]});const[r,_]=t.useState(""),[n,g]=t.useState(""),[l,v]=t.useState(""),[b,c]=t.useState(""),[y,f]=t.useState(!1),[o,N]=t.useState(""),x=[{value:"fedex",label:"FedEx"},{value:"ups",label:"UPS"},{value:"usps",label:"USPS"},{value:"dhl",label:"DHL"},{value:"other",label:"Other carrier"}],D=async m=>{if(m.preventDefault(),!r||!n.trim()){N("Please fill in all required fields");return}f(!0),N("");try{await R({orderId:a.id,action:"MARK_SHIPPED",carrier:r,trackingNumber:n,shipDate:l||new Date().toISOString(),notes:b,shippedAt:new Date().toISOString()})}catch{N("Failed to update shipping information")}finally{f(!1)}};return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsxs("h3",{children:["Mark as Shipped - Order #",a.id]}),e.jsx("p",{children:"Update shipping information for this order"})]}),e.jsxs("form",{onSubmit:D,children:[o&&e.jsx(P,{type:"error",children:o}),e.jsx("div",{className:"form-section",children:e.jsx(C,{label:"Shipping Carrier *",options:x,value:r,onChange:m=>_(m.target.value),required:!0})}),e.jsx("div",{className:"form-section",children:e.jsx(A,{label:"Tracking Number *",type:"text",placeholder:"Enter tracking number",value:n,onChange:m=>g(m.target.value),required:!0})}),e.jsx("div",{className:"form-section",children:e.jsx(A,{label:"Ship Date",type:"date",value:l,onChange:m=>v(m.target.value)})}),e.jsx("div",{className:"form-section",children:e.jsx(k,{label:"Shipping Notes (Optional)",rows:3,placeholder:"Any special shipping instructions, packaging details, or notes for the buyer...",value:b,onChange:m=>c(m.target.value)})}),e.jsxs("div",{className:"shipping-checklist",children:[e.jsx("h4",{children:"Shipping Verification:"}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",required:!0}),e.jsx("span",{children:"Package is properly sealed and labeled"})]}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",required:!0}),e.jsx("span",{children:"All items are included in the shipment"})]}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",required:!0}),e.jsx("span",{children:"Tracking information is accurate"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx(h,{type:"submit",variant:"primary",loading:y,disabled:!r||!n.trim(),children:"Confirm Shipped"}),e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Cancel"})]}),e.jsx("div",{className:"form-notice",children:e.jsxs("p",{children:["📦 ",e.jsx("strong",{children:"Note:"})," The buyer will be notified with tracking information once confirmed."]})})]})]})},le=({order:a,onSubmit:R,onCancel:p})=>{if(!a)return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h3",{children:"Error"}),e.jsx("p",{children:"Order information is not available"})]}),e.jsx("div",{className:"form-actions",children:e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Close"})})]});const[r,_]=t.useState(a.total_price||0),[n,g]=t.useState(""),[l,v]=t.useState(""),[b,c]=t.useState(!1),[y,f]=t.useState(""),o=[{value:"original_payment",label:"Refund to original payment method"},{value:"store_credit",label:"Issue store credit"},{value:"bank_transfer",label:"Bank transfer"},{value:"other",label:"Other method"}],N=async x=>{if(x.preventDefault(),!n||r<=0){f("Please fill in all required fields");return}c(!0),f("");try{await R({orderId:a.id,action:"PROCESS_REFUND",refundAmount:r,refundMethod:n,notes:l,processedAt:new Date().toISOString()})}catch{f("Failed to process refund")}finally{c(!1)}};return e.jsxs(E,{className:"order-form",children:[e.jsxs("div",{className:"form-header",children:[e.jsxs("h3",{children:["Process Refund - Order #",a.id]}),e.jsx("p",{children:"Process refund for the requested amount"})]}),e.jsxs("form",{onSubmit:N,children:[y&&e.jsx(P,{type:"error",children:y}),e.jsxs("div",{className:"form-section",children:[e.jsx(A,{label:"Refund Amount *",type:"number",min:"0.01",max:a.total_price||0,step:"0.01",value:r,onChange:x=>_(parseFloat(x.target.value)),required:!0}),e.jsxs("small",{children:["Maximum refundable amount: $",a.total_price||0]})]}),e.jsx("div",{className:"form-section",children:e.jsx(C,{label:"Refund Method *",options:o,value:n,onChange:x=>g(x.target.value),required:!0})}),e.jsx("div",{className:"form-section",children:e.jsx(k,{label:"Refund Notes (Optional)",rows:3,placeholder:"Any notes about the refund process, reasons, or communication with the buyer...",value:l,onChange:x=>v(x.target.value)})}),e.jsxs("div",{className:"refund-summary",children:[e.jsx("h4",{children:"Refund Summary"}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Original Order Total:"}),e.jsxs("span",{children:["$",a.total_price||0]})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Refund Amount:"}),e.jsxs("span",{className:"refund-amount",children:["$",r]})]}),r<(a.total_price||0)&&e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Amount Retained:"}),e.jsxs("span",{children:["$",((a.total_price||0)-r).toFixed(2)]})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx(h,{type:"submit",variant:"primary",loading:b,disabled:!n||r<=0,children:"Process Refund"}),e.jsx(h,{type:"button",variant:"outline",onClick:p,children:"Cancel"})]}),e.jsx("div",{className:"form-notice",children:e.jsxs("p",{children:["💰 ",e.jsx("strong",{children:"Processing Time:"})," Refunds typically take 3-5 business days to appear in the buyer's account."]})})]})]})},me=()=>{const[a,R]=t.useState([]),[p,r]=t.useState([]),[_,n]=t.useState(!0),[g,l]=t.useState(""),[v,b]=t.useState(""),[c,y]=t.useState({status:"",type:""}),[f,o]=t.useState(null),[N,x]=t.useState(!1),[D,m]=t.useState(null),w=W(),{user:O,userProfile:I}=X(),M=()=>I?{email:I.email||(O==null?void 0:O.email)||"",id:I.id||I._id||(O==null?void 0:O.uid)||"",type:I.role||I.user_type||"USER"}:O?{email:O.email||"",id:O.uid||"",type:"USER"}:{email:"",id:"",type:"USER"};t.useEffect(()=>{L()},[]),t.useEffect(()=>{V()},[a,c]);const L=async()=>{n(!0),l("");try{const s=await $.getOrders();if(s.success){const d=s.data.results||s.data||[];R(d)}else l(s.message||"Failed to load orders")}catch(s){console.error("Error fetching orders:",s),l("Failed to load orders")}finally{n(!1)}},V=()=>{let s=[...a];const d=M();c.status&&(s=s.filter(u=>u.status===c.status)),c.type&&(c.type==="BUYING"?s=s.filter(u=>u.buyer_email===d.email||u.buyer_id===d.id||u.buyer_type==="USER"):c.type==="SELLING"&&(s=s.filter(u=>u.seller_email===d.email||u.seller_id===d.id||u.seller_type==="USER"))),r(s)},Q=(s,d)=>{if(!s){l("Cannot open form: Order information is missing");return}const i={CANCEL_ORDER:se,REQUEST_REFUND:ae,CONFIRM_DELIVERY:re,CONFIRM_ORDER:te,REJECT_ORDER:ie,MARK_SHIPPED:ne,PROCESS_REFUND:le}[d];if(!i){l(`No form available for action: ${d}`);return}o(s),m(()=>i),x(!0)},G=async s=>{try{const{orderId:d,action:u,...i}=s;let j,S={};switch(u){case"CONFIRM_ORDER":S={status:"CONFIRMED",processing_time:i.processingTime,seller_notes:i.notes,estimated_ship_date:i.estimatedShipDate,confirmed_at:i.confirmedAt};break;case"REJECT_ORDER":S={status:"CANCELLED",cancellation_reason:i.details||i.reason||"Order rejected by seller",rejected_at:i.rejectedAt};break;case"MARK_SHIPPED":S={status:"SHIPPED",shipping_date:i.shipDate,carrier:i.carrier,tracking_number:i.trackingNumber,shipping_notes:i.notes,shipped_at:i.shippedAt};break;case"CONFIRM_DELIVERY":S={status:"DELIVERED",delivery_date:new Date().toISOString(),delivery_condition:i.condition,delivery_rating:i.rating,delivery_feedback:i.feedback,confirmed_at:i.confirmedAt};break;case"CANCEL_ORDER":S={status:"CANCELLED",cancellation_reason:i.reason||"Cancelled by buyer",additional_details:i.additionalDetails};break;case"REQUEST_REFUND":S={status:"REFUND_REQUESTED",refund_reason:i.description||i.reason||"Refund requested by buyer",refund_type:i.refundType,requested_refund_amount:i.requestedAmount};break;case"PROCESS_REFUND":S={status:"REFUNDED",refund_processed_date:new Date().toISOString(),refund_amount:i.refundAmount,refund_method:i.refundMethod,refund_notes:i.notes,processed_at:i.processedAt};break;default:throw new Error("Invalid action")}j=await $.updateOrder(d,S),j.success?(b({CONFIRM_ORDER:"Order confirmed successfully!",REJECT_ORDER:"Order rejected.",MARK_SHIPPED:"Order marked as shipped!",CONFIRM_DELIVERY:"Delivery confirmed!",CANCEL_ORDER:"Order cancelled.",REQUEST_REFUND:"Refund requested successfully!",PROCESS_REFUND:"Refund processed successfully!"}[u]||"Action completed successfully"),setTimeout(()=>b(""),4e3),L(),x(!1),m(null),o(null)):l(j.message||"Failed to perform action")}catch(d){console.error("Error performing order action:",d),l("Failed to perform action: "+d.message)}},H=()=>{if(!D||!f)return null;const s=D;return e.jsx(s,{order:f,onSubmit:G,onCancel:()=>{x(!1),m(null),o(null)}})},Y=s=>{s?w(`/marketplace/product/${s}`):l("Product information not available")},J=s=>{const d=M(),u=s.buyer_email===d.email||s.buyer_id===d.id||s.buyer_type==="USER",i=s.seller_email===d.email||s.seller_id===d.id||s.seller_type==="USER";console.log("🔍 DEBUG Role Detection:",{currentUser:d.email,orderBuyer:s.buyer_email,orderSeller:s.seller_email,isBuyer:u,isSeller:i,status:s.status});const j=[];s.status==="PENDING"?(i&&j.push({type:"CONFIRM_ORDER",label:"✅ Confirm Order",variant:"primary"},{type:"REJECT_ORDER",label:"❌ Reject Order",variant:"outline"}),u&&j.push({type:"CANCEL_ORDER",label:"🚫 Cancel Order",variant:"outline"})):s.status==="CONFIRMED"?(i&&j.push({type:"MARK_SHIPPED",label:"📦 Mark as Shipped",variant:"primary"}),u&&j.push({type:"CANCEL_ORDER",label:"🚫 Cancel Order",variant:"outline"})):s.status==="SHIPPED"?(u&&j.push({type:"CONFIRM_DELIVERY",label:"✅ Confirm Delivery",variant:"primary"},{type:"REQUEST_REFUND",label:"💸 Request Refund",variant:"outline"}),i&&j.push({type:"CONFIRM_DELIVERY",label:"✅ Confirm Delivery",variant:"primary"})):s.status==="DELIVERED"?u&&j.push({type:"REQUEST_REFUND",label:"💸 Request Refund",variant:"outline"}):s.status==="REFUND_REQUESTED"&&i&&j.push({type:"PROCESS_REFUND",label:"💰 Process Refund",variant:"primary"});const S=u?"💬 Contact Seller":"💬 Contact Buyer";return j.push({type:"CONTACT",label:S,variant:"text"}),console.log("🔍 DEBUG Final Actions:",j),j},K=s=>{switch(s){case"PENDING":return"warning";case"CONFIRMED":return"info";case"SHIPPED":return"primary";case"DELIVERED":return"success";case"CANCELLED":return"error";case"REFUND_REQUESTED":return"warning";case"REFUNDED":return"secondary";default:return"default"}},U=(s,d)=>{const u=["PENDING","CONFIRMED","SHIPPED","DELIVERED"],i=u.indexOf(s.status),j=u.indexOf(d);return j<i?"completed":j===i?"current":"pending"},F=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Not yet",B=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s||0);return _?e.jsxs("div",{className:"orders-loading",children:[e.jsx(Z,{size:"large"}),e.jsx("p",{children:"Loading orders..."})]}):e.jsxs("div",{className:"orders-page",children:[e.jsxs("div",{className:"orders-header",children:[e.jsx("h1",{children:"Orders"}),e.jsx("div",{className:"orders-actions",children:e.jsx(h,{variant:"outline",onClick:L,children:"🔄 Refresh"})})]}),g&&e.jsx(P,{type:"error",onClose:()=>l(""),children:g}),v&&e.jsx(P,{type:"success",onClose:()=>b(""),children:v}),e.jsx(E,{className:"orders-filters",children:e.jsxs("div",{className:"filters-grid",children:[e.jsx(C,{label:"Order Status",options:[{value:"",label:"All Statuses"},{value:"PENDING",label:"🟡 Pending"},{value:"CONFIRMED",label:"🔵 Confirmed"},{value:"SHIPPED",label:"📦 Shipped"},{value:"DELIVERED",label:"✅ Delivered"},{value:"CANCELLED",label:"❌ Cancelled"},{value:"REFUND_REQUESTED",label:"💸 Refund Requested"},{value:"REFUNDED",label:"💰 Refunded"}],value:c.status,onChange:s=>y(d=>({...d,status:s.target.value}))}),e.jsx(C,{label:"Order Type",options:[{value:"",label:"All Orders"},{value:"BUYING",label:"🛒 Orders I'm Buying"},{value:"SELLING",label:"🏪 Orders I'm Selling"}],value:c.type,onChange:s=>y(d=>({...d,type:s.target.value}))}),e.jsx("div",{className:"filter-stats",children:e.jsxs("span",{children:["📊 Showing ",p.length," of ",a.length," orders"]})})]})}),e.jsx("div",{className:"orders-list",children:p.length===0?e.jsx(E,{className:"no-orders",children:e.jsxs("div",{className:"no-orders-content",children:[e.jsx("h3",{children:"No orders found"}),e.jsx("p",{children:a.length===0?"You haven't placed or received any orders yet.":"No orders match your current filters."}),a.length===0&&e.jsx(h,{variant:"primary",onClick:()=>w("/marketplace"),children:"🏪 Browse Marketplace"})]})}):p.map(s=>{var u,i,j,S,T;const d=J(s);return e.jsxs(E,{className:"order-card",children:[e.jsxs("div",{className:"order-header",children:[e.jsxs("div",{className:"order-info",children:[e.jsxs("h3",{children:["Order #",s.id]}),e.jsx("div",{className:"status-badge-container",children:e.jsx(ee,{variant:K(s.status),children:s.status.replace("_"," ")})})]}),e.jsxs("div",{className:"order-meta",children:[e.jsxs("span",{className:"order-date",children:["📅 ",F(s.created_at)]}),e.jsxs("span",{className:"order-total",children:["💵 ",B(s.total_price)]})]})]}),e.jsxs("div",{className:"order-details",children:[e.jsxs("div",{className:"product-info",children:[e.jsx("div",{className:"product-image",children:(u=s.product_details)!=null&&u.image?e.jsx("img",{src:s.product_details.image,alt:s.product_details.title}):e.jsx("div",{className:"product-image-placeholder",children:"🌱"})}),e.jsxs("div",{className:"product-details",children:[e.jsx("h4",{children:((i=s.product_details)==null?void 0:i.title)||"Product"}),e.jsx("p",{className:"product-description",children:((j=s.product_details)==null?void 0:j.description)||"No description available"}),e.jsxs("div",{className:"product-specs",children:[e.jsxs("span",{children:["📦 Quantity: ",s.quantity]}),e.jsxs("span",{children:["💰 Price: ",B((S=s.product_details)==null?void 0:S.price)," each"]})]})]})]}),e.jsxs("div",{className:"order-parties",children:[e.jsxs("div",{className:"party-info",children:[e.jsx("strong",{children:"👤 Buyer:"}),e.jsx("span",{children:s.buyer_name||s.buyer_email||"Unknown"})]}),e.jsxs("div",{className:"party-info",children:[e.jsx("strong",{children:"🏪 Seller:"}),e.jsx("span",{children:s.seller_name||s.seller_email||"Unknown"})]})]}),e.jsxs("div",{className:"shipping-info",children:[e.jsxs("div",{className:"shipping-address",children:[e.jsx("strong",{children:"📮 Shipping Address:"}),e.jsx("p",{children:s.shipping_address||"Not specified"})]}),e.jsxs("div",{className:"contact-info",children:[e.jsx("strong",{children:"📞 Contact:"}),e.jsx("span",{children:s.contact_number||"Not provided"})]})]}),!["CANCELLED","REFUNDED","REFUND_REQUESTED"].includes(s.status)&&e.jsxs("div",{className:"order-timeline",children:[e.jsxs("div",{className:`timeline-step ${U(s,"PENDING")}`,children:[e.jsx("span",{className:"step-number",children:"1"}),e.jsx("span",{className:"step-label",children:"Order Placed"}),e.jsx("span",{className:"step-description",children:F(s.created_at)})]}),e.jsxs("div",{className:`timeline-step ${U(s,"CONFIRMED")}`,children:[e.jsx("span",{className:"step-number",children:"2"}),e.jsx("span",{className:"step-label",children:"Confirmed"}),e.jsx("span",{className:"step-description",children:s.status==="CONFIRMED"?"Seller confirmed":"Awaiting seller confirmation"})]}),e.jsxs("div",{className:`timeline-step ${U(s,"SHIPPED")}`,children:[e.jsx("span",{className:"step-number",children:"3"}),e.jsx("span",{className:"step-label",children:"Shipped"}),e.jsx("span",{className:"step-description",children:s.status==="SHIPPED"?`Shipped ${F(s.shipping_date)}`:"Ready for shipping"})]}),e.jsxs("div",{className:`timeline-step ${U(s,"DELIVERED")}`,children:[e.jsx("span",{className:"step-number",children:"4"}),e.jsx("span",{className:"step-label",children:"Delivered"}),e.jsx("span",{className:"step-description",children:s.status==="DELIVERED"?`Delivered ${F(s.delivery_date)}`:"In transit"})]})]}),s.status==="CANCELLED"&&s.cancellation_reason&&e.jsxs("div",{className:"status-message error",children:[e.jsx("strong",{children:"❌ Order Cancelled:"})," ",s.cancellation_reason]}),s.status==="REFUND_REQUESTED"&&s.refund_reason&&e.jsxs("div",{className:"status-message warning",children:[e.jsx("strong",{children:"💸 Refund Requested:"})," ",s.refund_reason,s.refund_requested_date&&e.jsxs("span",{children:[" (Requested: ",F(s.refund_requested_date),")"]})]}),s.status==="REFUNDED"&&s.refund_processed_date&&e.jsxs("div",{className:"status-message info",children:[e.jsx("strong",{children:"💰 Refund Processed:"})," ",F(s.refund_processed_date)]})]}),d.length>0&&e.jsxs("div",{className:"order-actions",children:[d.map((q,z)=>e.jsx(h,{variant:q.variant,size:"small",onClick:()=>{q.type==="CONTACT"?w("/messages"):Q(s,q.type)},children:q.label},z)),((T=s.product_details)==null?void 0:T.id)&&e.jsx(h,{variant:"text",size:"small",onClick:()=>Y(s.product_details.id),children:"👀 View Product"})]})]},s.id)})}),N&&e.jsx("div",{className:"modal-overlay",children:e.jsx("div",{className:"modal-content",children:H()})})]})};export{me as default};
//# sourceMappingURL=Orders-DhomQZDz.js.map
